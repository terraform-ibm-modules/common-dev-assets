{
  "extends":[
    "config:base",
    ":semanticCommits",
    ":disableDependencyDashboard"
  ],
  "recreateWhen": "always",
  "separateMajorMinor": false,
  "cloneSubmodules": true,
  "prConcurrentLimit": 0,
  "prHourlyLimit": 0,
  "automerge": false,
  "labels": ["renovate"],
  "rangeStrategy": "pin",
  "forkProcessing": "enabled",
  "git-submodules": {
    "enabled": false,
    "description": "workaround for https://github.com/renovatebot/renovate/issues/30279"
  },
  "pre-commit": {
    "enabled": true
  },
  "ignorePaths": [
    "**/node_modules/**"
  ],
  "postUpdateOptions": ["gomodTidy", "gomodUpdateImportPaths"],
  "postUpgradeTasks": {
    "description": "The below commands will run on the renovate branch code before pushing it. This ensures correct dependency versions are used for pre-commit hooks. NOTE: currently installing pipx with pip until the image supports it natively: https://github.com/renovatebot/renovate/discussions/39510",
    "commands": ["git submodule update --remote --merge && export CUSTOM_DIRECTORY=/tmp && export PIPX_GLOBAL_HOME=/tmp && export PATH=$PATH:/tmp && python3 -m pip install -q --upgrade pipx && pipx ensurepath --global && make dependency-install-darwin-linux && cp /opt/containerbase/tools/golang/*/bin/gofmt /tmp", "export PATH=$PATH:/tmp && pre-commit run --all-files || true"],
    "fileFilters": ["**/*.md", "**/*.py", "**/*.toml", "**/*.json", ".secrets.baseline", "**/*.tf", "**/*.go", "go.mod", "go.sum", "common-dev-assets", "armada-csutil", "modules/logs-routing-module/helm-charts", "modules/prometheus-module/helm-charts"],
    "executionMode": "branch"
  },
  "packageRules": [
    {
      "description": "Group all dependencies into a single PR",
      "matchPackagePatterns": ["*"],
      "groupName": "dependencies"
    },
    {
      "description": "Use fix as Semantic Commit prefix for all dependency updates except ones specified in rules below",
      "matchPackagePatterns": ["*"],
      "semanticCommitType": "fix"
    },
    {
      "description": "Use chore as Semantic Commit prefix for all dependency updates in examples and tests folders",
      "matchFileNames": ["examples/**", "tests/**"],
      "semanticCommitType": "chore"
    },
    {
      "description": "Use chore as Semantic Commit prefix for git submodule, go.mod, github actions, and pre-commit updates, and bundle into the same PR to reduce number of PRs created by renovate.",
      "matchManagers": ["git-submodules", "gomod", "pre-commit", "github-actions"],
      "semanticCommitType": "chore"
    },
    {
      "description": "Disable terraform required_version and required_provider updates.",
      "matchManagers": ["terraform"],
      "matchDepTypes": ["required_version", "required_provider"],
      "enabled": false
    },
    {
      "description": "Allow the locked in provider version to be updated to the latest for deployable architectures",
      "enabled": true,
      "matchFileNames": ["solutions/**"],
      "matchManagers": ["terraform"],
      "matchDepTypes": ["required_provider"],
      "rangeStrategy": "bump",
      "semanticCommitType": "fix"
    },
    {
      "description": "Custom regex required to bump IBM detect secrets",
      "matchPackageNames": ["ibm/detect-secrets"],
      "versioning": "regex:^(?<compatibility>.*)-?(?<major>\\d+)\\.(?<minor>\\d+)\\+ibm\\.(?<patch>\\d+)\\.dss$"
    }
  ]
}
